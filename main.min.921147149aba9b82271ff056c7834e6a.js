// 1599231725296
const monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function makeMMDDYYYY(t,e="/"){const a=new Date(t).toLocaleString("en-US").split(",")[0].split("/");return""+(a[0]+e+a[1]+e+a[2])}function makeMMMYYYY(t,e=" "){const a=new Date(t).toLocaleString("en-US").split(",")[0].split("/");return""+(monthNamesShort[a[0]-1]+e+a[2])}function makeYYYY(t,e="/"){return""+new Date(t).toLocaleString("en-US").split(",")[0].split("/")[2]}$((function(){var t=document.getElementById("echart_bar"),e={grid:{top:"6",right:"0",bottom:"17",left:"25"},xAxis:{data:["2014","2015","2016","2017","2018"],axisLabel:{fontSize:10,color:"#9aa0ac"}},tooltip:{show:!0,showContent:!0,alwaysShowContent:!1,triggerOn:"mousemove",trigger:"axis",axisPointer:{label:{show:!1}}},yAxis:{axisLabel:{fontSize:10,color:"#9aa0ac"}},series:[{name:"sales",type:"bar",barMaxWidth:10,data:[13,14,10,16,11,13]},{name:"growth",type:"bar",barMaxWidth:10,data:[10,14,10,15,9,25]}],color:["#9f78ff","#32cafe"]};echarts.init(t).setOption(e);var a=document.getElementById("chart-1").getContext("2d");new Chart(a,{type:"line",data:{labels:["January","February","March","April","May"],datasets:[{label:"Sales",data:[10,35,27,55,30],borderWidth:2,backgroundColor:"rgba(78, 214, 193, .8)",borderWidth:0,borderColor:"transparent",pointBorderWidth:0,pointRadius:2,pointBackgroundColor:"transparent",pointHoverBackgroundColor:"rgba(63,82,227,.8)"}]},options:{legend:{display:!1},scales:{yAxes:[{gridLines:{drawBorder:!1,color:"#f2f2f2"},ticks:{beginAtZero:!0,stepSize:10,fontColor:"#9aa0ac",callback:function(t,e,a){return"$"+t}}}],xAxes:[{gridLines:{display:!1,tickMarkLength:15},ticks:{fontColor:"#9aa0ac"}}]}}})})),feather.replace(),$((function(){let t={cursoropacitymin:0,cursoropacitymax:.8,zindex:892},e=null;var a;$("body").hasClass("layout-2")&&($("body.layout-2 #sidebar-wrapper").stick_in_parent({parent:$("body")}),$("body.layout-2 #sidebar-wrapper").stick_in_parent({recalc_every:1}));var s=function(){let t=setInterval((function(){null!=a&&a.resize()}),10);setTimeout((function(){clearInterval(t)}),600)},o=function(){$(".main-sidebar").length&&($(".main-sidebar").niceScroll(t),a=$(".main-sidebar").getNiceScroll(),$(".main-sidebar .sidebar-menu li a.has-dropdown").off("click").on("click",(function(){return $(this).parent().find("> .dropdown-menu").slideToggle(500,(function(){return s(),!1})),!1})))};o(),$("#top-5-scroll").length&&$("#top-5-scroll").css({height:315}).niceScroll(),$("#scroll-new").length&&$("#scroll-new").css({height:200}).niceScroll(),$(".main-content").css({minHeight:$(window).outerHeight()-95}),$(".nav-collapse-toggle").click((function(){return $(this).parent().find(".navbar-nav").toggleClass("show"),!1})),$(document).on("click",(function(t){$(".nav-collapse .navbar-nav").removeClass("show")}));var i=function(e){let s=$("body");e?(s.addClass("sidebar-mini"),s.removeClass("sidebar-show"),a.remove(),a=null,$(".main-sidebar .sidebar-menu > li").each((function(){let t=$(this);t.find("> .dropdown-menu").length?(t.find("> .dropdown-menu").hide(),t.find("> .dropdown-menu").prepend('<li class="dropdown-title pt-3">'+t.find("> a").text()+"</li>")):(t.find("> a").attr("data-toggle","tooltip"),t.find("> a").attr("data-original-title",t.find("> a").text()),$("[data-toggle='tooltip']").tooltip({placement:"right"}))}))):(s.removeClass("sidebar-mini"),$(".main-sidebar").css({overflow:"hidden"}),setTimeout((function(){$(".main-sidebar").niceScroll(t),a=$(".main-sidebar").getNiceScroll()}),500),$(".main-sidebar .sidebar-menu > li > ul .dropdown-title").remove(),$(".main-sidebar .sidebar-menu > li > a").removeAttr("data-toggle"),$(".main-sidebar .sidebar-menu > li > a").removeAttr("data-original-title"),$(".main-sidebar .sidebar-menu > li > a").removeAttr("title"))};$("[data-toggle='sidebar']").click((function(){var t=$("body");return $(window).outerWidth()<=1024?(t.removeClass("search-show search-gone"),t.hasClass("sidebar-gone")?(t.removeClass("sidebar-gone"),t.addClass("sidebar-show")):(t.addClass("sidebar-gone"),t.removeClass("sidebar-show")),s()):(t.removeClass("search-show search-gone"),t.hasClass("sidebar-mini")?i(!1):i(!0)),!1}));var r=function(){var r=$(window),n=$("body").attr("class")||"",l=n.trim().length>0?n.split(" "):"";if(l.length>0&&l.forEach((function(t){-1!=t.indexOf("layout-")&&(e=t)})),r.outerWidth()<=1024){if($("body").hasClass("sidebar-mini")&&(i(!1),$(".main-sidebar").niceScroll(t),a=$(".main-sidebar").getNiceScroll()),$("body").addClass("sidebar-gone"),$("body").removeClass("layout-2 layout-3 sidebar-mini sidebar-show"),$("body").off("click").on("click",(function(t){($(t.target).hasClass("sidebar-show")||$(t.target).hasClass("search-show"))&&($("body").removeClass("sidebar-show"),$("body").addClass("sidebar-gone"),$("body").removeClass("search-show"),s())})),s(),"layout-3"==e){let e=$(".navbar-secondary").attr("class"),s=$(".navbar-secondary");s.attr("data-nav-classes",e),s.removeAttr("class"),s.addClass("main-sidebar");let i=$(".main-sidebar");i.find(".container").addClass("sidebar-wrapper").removeClass("container"),i.find(".navbar-nav").addClass("sidebar-menu").removeClass("navbar-nav"),i.find(".sidebar-menu .nav-item.dropdown.show a").click(),i.find(".sidebar-brand").remove(),i.find(".sidebar-menu").before($("<div>",{class:"sidebar-brand"}).append($("<a>",{href:$(".navbar-brand").attr("href")}).html($(".navbar-brand").html()))),setTimeout((function(){a=i.niceScroll(t),a=i.getNiceScroll()}),700),o(),$(".main-wrapper").removeClass("container")}}else{$("body").removeClass("sidebar-gone sidebar-show"),e&&$("body").addClass(e);let t=$(".main-sidebar").attr("data-nav-classes"),a=$(".main-sidebar");if("layout-3"==e&&a.hasClass("main-sidebar")){a.find(".sidebar-menu li a.has-dropdown").off("click"),a.find(".sidebar-brand").remove(),a.removeAttr("class"),a.addClass(t);let e=$(".navbar-secondary");e.find(".sidebar-wrapper").addClass("container").removeClass("sidebar-wrapper"),e.find(".sidebar-menu").addClass("navbar-nav").removeClass("sidebar-menu"),e.find(".dropdown-menu").hide(),e.removeAttr("style"),e.removeAttr("tabindex"),e.removeAttr("data-nav-classes"),$(".main-wrapper").addClass("container")}else"layout-2"==e?$("body").addClass("layout-2"):s()}};r(),$(window).resize(r),$("[data-toggle='search']").click((function(){var t=$("body");t.hasClass("search-gone")?(t.addClass("search-gone"),t.removeClass("search-show")):(t.removeClass("search-gone"),t.addClass("search-show"))})),$("[data-toggle='tooltip']").tooltip(),$('[data-toggle="popover"]').popover({container:"body"}),jQuery().select2&&$(".select2").select2(),jQuery().selectric&&$(".selectric").selectric({disableOnMobile:!1,nativeOnMobile:!1}),$(".notification-toggle").dropdown(),$(".notification-toggle").parent().on("shown.bs.dropdown",(function(){$(".dropdown-list-icons").niceScroll({cursoropacitymin:.3,cursoropacitymax:.8,cursorwidth:7})})),$(".message-toggle").dropdown(),$(".message-toggle").parent().on("shown.bs.dropdown",(function(){$(".dropdown-list-message").niceScroll({cursoropacitymin:.3,cursoropacitymax:.8,cursorwidth:7})})),jQuery().summernote&&($(".summernote").summernote({dialogsInBody:!0,minHeight:250}),$(".summernote-simple").summernote({dialogsInBody:!0,minHeight:150,toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough"]],["para",["paragraph"]]]})),$("[data-dismiss]").each((function(){var t=$(this),e=t.data("dismiss");t.click((function(){return $(e).fadeOut((function(){$(e).remove()})),!1}))})),$("[data-collapse]").each((function(){var t=$(this),e=t.data("collapse");t.click((function(){return $(e).collapse("toggle"),$(e).on("shown.bs.collapse",(function(){t.html('<i class="fas fa-minus"></i>')})),$(e).on("hidden.bs.collapse",(function(){t.html('<i class="fas fa-plus"></i>')})),!1}))})),$("[data-background]").each((function(){var t=$(this);t.css({backgroundImage:"url("+t.data("background")+")"})})),$("[data-tab]").each((function(){var t=$(this);t.click((function(){if(!t.hasClass("active")){$('[data-tab-group="'+t.data("tab")+'"]');var e=$('[data-tab-group="'+t.data("tab")+'"].active'),a=$(t.attr("href"));$('[data-tab="'+t.data("tab")+'"]').removeClass("active"),t.addClass("active"),a.addClass("active"),e.removeClass("active")}return!1}))})),$(".needs-validation").submit((function(){var t=$(this);!1===t[0].checkValidity()&&(event.preventDefault(),event.stopPropagation()),t.addClass("was-validated")})),$(".alert-dismissible").each((function(){var t=$(this);t.find(".close").click((function(){t.alert("close")}))})),$(".main-navbar").length,$("[data-crop-image]").each((function(t){$(this).css({overflow:"hidden",position:"relative",height:$(this).data("crop-image")})})),$("[data-toggle-slide]").click((function(){let t=$(this).data("toggle-slide");return $(t).slideToggle(),!1})),$("[data-dismiss=modal]").click((function(){return $(this).closest(".modal").modal("hide"),!1})),$("[data-width]").each((function(){$(this).css({width:$(this).data("width")})})),$("[data-height]").each((function(){$(this).css({height:$(this).data("height")})})),$(".chocolat-parent").length&&jQuery().Chocolat&&$(".chocolat-parent").Chocolat(),$(".sortable-card").length&&jQuery().sortable&&$(".sortable-card").sortable({handle:".card-header",opacity:.8,tolerance:"pointer"}),jQuery().daterangepicker&&($(".datepicker").length&&$(".datepicker").daterangepicker({locale:{format:"YYYY-MM-DD"},singleDatePicker:!0}),$(".datetimepicker").length&&$(".datetimepicker").daterangepicker({locale:{format:"YYYY-MM-DD hh:mm"},singleDatePicker:!0,timePicker:!0,timePicker24Hour:!0}),$(".daterange").length&&$(".daterange").daterangepicker({locale:{format:"YYYY-MM-DD"},drops:"down",opens:"right"})),jQuery().timepicker&&$(".timepicker").length&&$(".timepicker").timepicker({icons:{up:"fas fa-chevron-up",down:"fas fa-chevron-down"}}),$("#mini_sidebar_setting").on("change",(function(){var t=$(this).is(":checked")?"checked":"unchecked";i("checked"===t)})),$(".theme-setting-toggle").on("click",(function(){$(".theme-setting")[0].classList.contains("active")?$(".theme-setting")[0].classList.remove("active"):$(".theme-setting")[0].classList+=" active"})),$(document).on("click",".fullscreen-btn",(function(t){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)})),$(".settingPanelToggle").on("click",(function(){$(".settingSidebar").toggleClass("showSettingPanel")})),$(".page-wrapper").on("click",(function(){$(".settingSidebar").removeClass("showSettingPanel")}));var n=!1;$(".settingSidebar").hover((function(){n=!0}),(function(){n=!1})),$("body").mouseup((function(){n||$(".settingSidebar").removeClass("showSettingPanel")})),$(".settingSidebar-body").niceScroll(),$(".choose-theme li").on("click",(function(){var t=$("body"),e=$(this),a=$(".choose-theme li.active").attr("title");$(".choose-theme li").removeClass("active"),e.addClass("active"),$(".choose-theme li.active").data("theme"),t.removeClass("theme-"+a),t.addClass("theme-"+$(this).attr("title"))})),$(".sidebar-color input:radio").change((function(){"1"==$(this).val()?($("body").removeClass("dark-sidebar"),$("body").addClass("light-sidebar")):($("body").removeClass("light-sidebar"),$("body").addClass("dark-sidebar"))})),$(".layout-color input:radio").change((function(){"1"==$(this).val()?($("body").removeClass(),$("body").addClass("light"),$("body").addClass("light-sidebar"),$("body").addClass("theme-white"),$(".choose-theme li").removeClass("active"),$(".choose-theme li[title|='white']").addClass("active"),$(".selectgroup-input[value|='1']").prop("checked",!0)):($("body").removeClass(),$("body").addClass("dark"),$("body").addClass("dark-sidebar"),$("body").addClass("theme-black"),$(".choose-theme li").removeClass("active"),$(".choose-theme li[title|='black']").addClass("active"),$(".selectgroup-input[value|='2']").prop("checked",!0))})),$(".btn-restore-theme").on("click",(function(){$("body").removeClass(),jQuery("body").addClass("light"),jQuery("body").addClass("light-sidebar"),jQuery("body").addClass("theme-white"),$(".choose-theme li").removeClass("active"),$(".choose-theme li[title|='white']").addClass("active"),$(".select-layout[value|='1']").prop("checked",!0),$(".select-sidebar[value|='2']").prop("checked",!0),i(!1),$("#mini_sidebar_setting").prop("checked",!1)})),jQuery("body").addClass("light"),jQuery("body").addClass("light-sidebar"),jQuery("body").addClass("theme-white"),$(".choose-theme li").removeClass("active"),$(".choose-theme li[title|='white']").addClass("active"),$(".select-layout[value|='1']").prop("checked",!0),$(".select-sidebar[value|='1']").prop("checked",!0)}));const debug=!0;var requestInfo={status:!1,reDraw:!1,time:(new Date).getTime(),text:"debug",meta:"none"};const callServer=google.script.run.withSuccessHandler(defaultSuccessHandler).withFailureHandler(defaultFailureHandler),classes={},queueExec=[];function defaultSuccessHandler(t){requestDone(t)}function defaultFailureHandler(t){alert("<hr>defaultFailureHandler return:<br>"+t),requestDone(t)}function requestLog(t,e=!0,a=!1){return!!requestInfo.status||(requestInfo.status=!0,requestInfo.time=(new Date).getTime(),requestInfo.text=t,requestInfo.reDraw=a,console.log("=> Running request "+requestInfo.text),!1)}function requestDone(t){$(".loader").fadeOut("slow"),requestInfo.status=!1,requestInfo.meta="none",console.log("=> Request '"+requestInfo.text+"' took "+((new Date).getTime()-requestInfo.time)/1e3+" seconds"),console.log(t),console.log("=========================================="),queueExec.length>0&&startQueueForAgentInfo()}function startQueueForAgentInfo(){let t=queueExec.shift();console.log(arguments.callee.name+" start exec with "+(adminList.includes(userEmail)?"all":userEmail)),t()}function requestInProgress(){return"=> Currently executing: "+requestInfo.text}function getNameFromEmail(t){var e=t.split("@")[0].split(".");return 1==e.length?e[0].charAt(0).toUpperCase()+e[0].slice(1):e[0].charAt(0).toUpperCase()+e[0].slice(1)+" "+e[1].charAt(0).toUpperCase()+e[1].slice(1)}function hashCode(t){for(var e=0,a=0;a<t.length;a++)e=t.charCodeAt(a)+((e<<5)-e);return e}function hexToRgb(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function intToHEX(t){var e=(16777215&t).toString(16).toUpperCase();return"00000".substring(0,6-e.length)+e}function getColorHEX(t){return"#"+intToHEX(hashCode(t))}function getColorRGB(t){return hexToRgb(getColorHEX(t))}function getRGBAString(t){const e=hexToRgb(getColorHEX(t));return`rgba(${e.r}, ${e.g}, ${e.b}, 0.6)`}String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.getName=function(){let t="";if(-1!=this.indexOf("-Agent-"))t=this.split("-")[2].split("@")[0].split(".")[0].charAt(0).toUpperCase()+this.split("-")[2].split("@")[0].split(".")[0].slice(1)+" "+this.split("-")[2].split("@")[0].split(".")[1].charAt(0).toUpperCase()+this.split("-")[2].split("@")[0].split(".")[1].slice(1);else if(-1!=this.indexOf("@"))t=this.split("@")[0].split(".")[0].charAt(0).toUpperCase()+this.split("@")[0].split(".")[0].slice(1)+" "+this.split("@")[0].split(".")[1].charAt(0).toUpperCase()+this.split("@")[0].split(".")[1].slice(1);else try{t=this.split(".")[0].charAt(0).toUpperCase()+this.split(".")[0].slice(1)+" "+this.split(".")[1].charAt(0).toUpperCase()+this.split(".")[1].slice(1)}catch(t){console.log(this,t)}return t};class localStorageSingletone{constructor(){this.storages=new Map}add(t,e){this.storages.set(t,e)}get(t){return this.storages.get(t)}}const localStorages=new localStorageSingletone;class CRMAppStats{constructor(t){this.class=CRMAppStats,this.count=0,t?(this.date=t.date,this.time=t.time,this.total=t.total,this.typeDirect=t.typeDirect,this.typePS=t.typePS,this.typeOB=t.typeOB,this.typeTS=t.typeTS,this.suitePro=t.suitePro,this.suiteEnt=t.suiteEnt,this.suiteBsc=t.suiteBsc,this.imports=t.imports,this.outCompleted=t.outCompleted,this.outRescheduled=t.outRescheduled,this.outDeclined=t.outDeclined,this.outNoShow=t.outNoShow,this.rules=t.rules,this.calendar=t.calendar,this.stopics=t.stopics,this.analytics=t.analytics,this.surveys=t.surveys,this.chat=t.chat,this.other=t.other,this.successComplete=t.successComplete):(this.date="",this.time=0,this.total=0,this.typeDirect=0,this.typePS=0,this.typeOB=0,this.typeTS=0,this.suitePro=0,this.suiteEnt=0,this.suiteBsc=0,this.imports=0,this.outCompleted=0,this.outRescheduled=0,this.outDeclined=0,this.outNoShow=0,this.rules=0,this.calendar=0,this.stopics=0,this.analytics=0,this.surveys=0,this.chat=0,this.other=0,this.successComplete=0)}add(t){this.count++,this.date||(this.date=t.date),this.time||(this.time=t.time),this.total+=t.total,this.typeDirect+=t.typeDirect,this.typePS+=t.typePS,this.typeOB+=t.typeOB,this.typeTS+=t.typeTS,this.suitePro+=t.suitePro,this.suiteEnt+=t.suiteEnt,this.suiteBsc+=t.suiteBsc,this.imports+=t.imports,this.outCompleted+=t.outCompleted,this.outRescheduled+=t.outRescheduled,this.outDeclined+=t.outDeclined,this.outNoShow+=t.outNoShow,this.rules+=t.rules,this.calendar+=t.calendar,this.stopics+=t.stopics,this.analytics+=t.analytics,this.surveys+=t.surveys,this.chat+=t.chat,this.other+=t.other,this.successComplete+=t.successComplete}}classes.CRMAppStats=CRMAppStats,localStorages.add("CRMAppStats",new Map);class DatePickrControl{constructor(){this.initiated=!1,this.pickrFrom,this.pickrTo}getToTime(){return this.pickrTo.selectedDates[0].setHours(23,59,59,59)}getFromTime(){return this.pickrFrom.selectedDates[0].setHours(0,0,0,1)}getTo(){return this.pickrTo.selectedDates[0]}getFrom(){return this.pickrFrom.selectedDates[0]}init(){if(this.initiated)return console.error("DatePickrControl initiation more than 1 time");this.initiated=!0,this.pickrFrom=this.createFromPickr(),this.pickrTo=this.createToPickr()}createFromPickr(){return flatpickr("#flatpickr-obt-fromdate",{maxDate:"today",altInput:!0,altFormat:"F j, Y",defaultDate:[new Date((new Date).setDate((new Date).getDate()-7))],dateFormat:"Y-m-d",locale:{firstDayOfWeek:1},onChange:function(t,e,a){1==t.length&&updateToPickr(t[0])},getWeek:function(t){}})}createToPickr(){return flatpickr("#flatpickr-obt-todate",{maxDate:"today",altInput:!0,altFormat:"F j, Y",defaultDate:["today"],dateFormat:"Y-m-d",locale:{firstDayOfWeek:1},onChange:function(t,e,a){1==t.length&&updateFromPickr(t[0])},getWeek:function(t){}})}}const dateSelector=new DatePickrControl;function updateFromPickr(t){dateSelector.pickrFrom.config.disable=[function(e){return moment(e)>moment(t)}],dateSelector.pickrFrom.redraw(),runUpdate()}function updateToPickr(t){dateSelector.pickrTo.config.disable=[function(e){return moment(e)<moment(t)}],dateSelector.pickrTo.redraw(),runUpdate()}dateSelector.init();class FTAppStats{constructor(t){this.class=FTAppStats,this.count=0,t?(this.date=t.date,this.time=t.time,this.total=t.total,this.made=t.made,this.noshow=t.noshow,this.declined=t.declined,this.reschedule=t.reschedule):(this.date="",this.time=0,this.total=0,this.made=0,this.noshow=0,this.declined=0,this.reschedule=0)}add(t){this.date||(this.date=t.date),this.time||(this.time=t.time),this.count++,this.total+=t.total,this.made+=t.made,this.noshow+=t.noshow,this.declined+=t.declined,this.reschedule+=t.reschedule}}classes.FTAppStats=FTAppStats,localStorages.add("FTAppStats",new Map);class FTCompletionStats{constructor(t){this.class=FTCompletionStats,this.count=0,t?(this.date=t.date,this.time=t.time,this.total=t.total,this.confirmed=t.confirmed,this.passive=t.passive,this.declined=t.declined,this.cancel=t.cancel):(this.date="",this.time=0,this.total=0,this.confirmed=0,this.passive=0,this.declined=0,this.cancel=0)}add(t){this.date||(this.date=t.date),this.time||(this.time=t.time),this.count++,this.total+=t.total,this.confirmed+=t.confirmed,this.passive+=t.passive,this.declined+=t.declined,this.cancel+=t.cancel}}classes.FTCompletionStats=FTCompletionStats,localStorages.add("FTCompletionStats",new Map);class OBContactsStats{constructor(t){this.class=OBContactsStats,this.count=0,t?(this.date=t.date,this.time=t.time,this.name=t.name,this.team=t.team,this.zero3=t.zero3,this.four=t.four,this.fiveplus=t.fiveplus,this.zero3perc=t.zero3perc,this.fourperc=t.fourperc,this.fiveplus=t.fiveplus,this.total=t.total,this.totalperc=t.totalperc):(this.date=0,this.time=0,this.name=0,this.team=0,this.zero3=0,this.four=0,this.fiveplus=0,this.zero3perc=0,this.fourperc=0,this.fiveplus=0,this.total=0,this.totalperc=0)}add(t){this.date||(this.date=t.date),this.time||(this.time=t.time),this.name||(this.name=t.name),this.team||(this.team=t.team),this.zero3+=t.zero3,this.four+=t.four,this.fiveplus+=t.fiveplus,this.zero3perc+=t.zero3perc,this.fourperc+=t.fourperc,this.fiveplus+=t.fiveplus,this.total+=t.total,this.totalperc+=t.totalperc}}classes.OBContactsStats=OBContactsStats,localStorages.add("OBContactsStats",new Map);class OBPortfolioStats{constructor(t){this.class=OBPortfolioStats,this.count=0,t?(this.date="",this.time=0,this.pm=t.pm,this.queue=t.queue,this.beg=t.beg,this.endportfolio=t.endportfolio,this.portfolio=t.portfolio,this.lcyesterday=t.lcyesterday,this.notcontacted48h=t.notcontacted48h,this.notcontacted72h=t.notcontacted72h,this.t1createdyesterday=t.t1createdyesterday,this.t1createdalltime=t.t1createdalltime,this.inboundcalls=t.inboundcalls,this.outboundcalls=t.outboundcalls,this.internalcalls=t.internalcalls,this.totalcalls=t.totalcalls,this.tickets=t.tickets,this.totaltolktime=t.totaltolktime,this.callsporfolioratio=t.callsporfolioratio):(this.date="",this.time=0,this.pm="",this.queue=0,this.beg=0,this.endportfolio=0,this.portfolio=0,this.lcyesterday=0,this.notcontacted48h=0,this.notcontacted72h=0,this.t1createdyesterday=0,this.t1createdalltime=0,this.inboundcalls=0,this.outboundcalls=0,this.internalcalls=0,this.totalcalls=0,this.tickets=0,this.totaltolktime=0,this.callsporfolioratio=0)}add(t){this.total++,this.date||(this.date=t.date),this.time||(this.time=t.time),this.pm||(this.pm=t.pm),this.queue||(this.queue=t.queue),this.beg+=t.beg,this.endportfolio+=t.endportfolio,this.portfolio+=t.portfolio,this.lcyesterday+=t.lcyesterday,this.notcontacted48h+=t.notcontacted48h,this.notcontacted72h+=t.notcontacted72h,this.t1createdyesterday+=t.t1createdyesterday,this.t1createdalltime+=t.t1createdalltime,this.inboundcalls+=t.inboundcalls,this.outboundcalls+=t.outboundcalls,this.internalcalls+=t.internalcalls,this.totalcalls+=t.totalcalls,this.tickets+=t.tickets,this.totaltolktime+=getseconds(t.totaltolktime),this.callsporfolioratio+=t.callsporfolioratio}}classes.OBPortfolioStats=OBPortfolioStats,localStorages.add("OBPortfolioStats",new Map);class OBTAppStats{constructor(t){this.class=OBTAppStats,t?(this.date=t.date,this.time=t.time,this.total=t.total,this.typeImpl=t.typeImpl,this.typeNet=t.typeNet,this.typeTS=t.typeTS,this.typeTR=t.typeTR,this.typeOCS=t.typeOCS,this.outMade=t.outMade):(this.date="",this.time=0,this.total=0,this.typeImpl=0,this.typeNet=0,this.typeTS=0,this.typeTR=0,this.typeOCS=0,this.outMade=0)}add(t){this.date||(this.date=t.date),this.time||(this.time=t.time),this.count++,this.total+=t.total,this.typeImpl+=t.typeImpl,this.typeNet+=t.typeNet,this.typeTS+=t.typeTS,this.typeTR+=t.typeTR,this.typeOCS+=t.typeOCS,this.outMade+=t.outMade}}classes.OBTAppStats=OBTAppStats,localStorages.add("OBTAppStats",new Map);class OBTCasesStats{constructor(t){this.class=OBTCasesStats,t?(this.date=t.date,this.time=t.time,this.total=t.total,this.builds=t.builds,this.updates=t.updates,this.assignments=t.assignments,this.mid=t.mid,this.enterprise=t.enterprise,this.fasttrack=t.fasttrack,this.migration=t.migration,this.insidesales=t.insidesales,this.channel=t.channel,this.franchise=t.franchise,this.otherSale=t.otherSale,this.usersCreated=t.usersCreated,this.usersUpdated=t.usersUpdated,this.featuresCreated=t.featuresCreated,this.featuresUpdated=t.featuresUpdated,this.servicesCreated=t.servicesCreated,this.servicesUpdated=t.servicesUpdated,this.other=t.other):(this.date="",this.time=0,this.total=0,this.builds=0,this.updates=0,this.assignments=0,this.mid=0,this.enterprise=0,this.fasttrack=0,this.migration=0,this.insidesales=0,this.channel=0,this.franchise=0,this.otherSale=0,this.usersCreated=0,this.usersUpdated=0,this.featuresCreated=0,this.featuresUpdated=0,this.servicesCreated=0,this.servicesUpdated=0,this.other=0)}add(t){this.date||(this.date=t.date),this.time||(this.time=t.time),this.total+=t.total,this.builds+=t.builds,this.updates+=t.updates,this.assignments+=t.assignments,this.mid+=t.mid,this.enterprise+=t.enterprise,this.fasttrack+=t.fasttrack,this.migration+=t.migration,this.insidesales+=t.insidesales,this.channel+=t.channel,this.franchise+=t.franchise,this.otherSale+=t.otherSale,this.usersCreated+=t.usersCreated,this.usersUpdated+=t.usersUpdated,this.featuresCreated+=t.featuresCreated,this.featuresUpdated+=t.featuresUpdated,this.servicesCreated+=t.servicesCreated,this.servicesUpdated+=t.servicesUpdated,this.other+=t.other}}classes.OBTCasesStats=OBTCasesStats,localStorages.add("OBTCasesStats",new Map),localStorages.add("teamRoaster",new Map),$(window).on("load",(function(){if(console.log("=> Page took to load "+((new Date).getTime()-timePageLoading)/1e3+" seconds"),requestLog(arguments.callee.name))return showAlert(requestInProgress());callServer.withSuccessHandler(onDataLoaded).getStorage()}));const onLoadQueue=[];function onDataLoaded(t){console.groupCollapsed("Saving Stats Log");for(const e of t[1])saveStats(e);combineByDateSort(),console.groupEnd(),onLoadQueue.forEach(e=>{e(t)}),$(".obt-dashboard-page-container:not(:first-of-type)").hide(),runUpdate(),requestDone(t)}const updateQueue=[],countQueue=[];function runUpdate(){countQueue.forEach(t=>{t()}),updateQueue.forEach(t=>{t()})}const statsTypes=["OBTCasesStats","OBTAppStats","FTCompletionStats","CRMAppStats"];function countWorkDays(t,e){const a=new Date(t),s=new Date(e);a.setHours(0,0,0,1),s.setHours(23,59,59,999);let o=s-a,i=Math.ceil(o/864e5);i-=2*Math.floor(i/7);let r=a.getDay(),n=s.getDay();r-n>1&&(i-=2),0==r&&6!=n&&i--,6==n&&0!=r&&i--}function countPeriods(){const t=dateSelector.getFromTime(),e=dateSelector.getToTime();console.log(t);const a={text:"",from:t,to:e},s=countWorkDays(t,e);console.log(`Selected ${s} work days.`);const o={text:"",from:t-(e-t),to:t-1e3};console.groupCollapsed("==********[ countPeriods ]*********=="),console.log("crntPeriod",a),console.log("prvsPeriod",o),console.groupCollapsed("Included list"),statsTypes.forEach(t=>{const e=localStorages.get(t);console.log("==*********************************=="),console.log("-------------------------------------"),console.log("Working with "+t),console.log(e),console.log("-------------------------------------"),a.text=t+"-CurrentPeriod",o.text=t+"-PreviousePeriod",e.set(a.text,""),e.set(o.text,""),e.forEach((t,s)=>{if(-1!==s.indexOf("-Date-"))if(t.time>=a.from&&t.time<=a.to){console.log("included in current period",t);let s=e.get(a.text);s||(s=new t.class),s.add(t),e.set(a.text,s)}else if(t.time>=o.from&&t.time<=o.to){console.log("included in previouse period",t);let a=e.get(o.text);a||(a=new t.class),a.add(t),e.set(o.text,a)}})}),console.groupEnd(),console.log("==*********************************=="),console.groupEnd()}countQueue.push(countPeriods);class dashFTchartSingletone{constructor(){this.chart=echarts.init(document.getElementById("dashboard-chart-ft-completions"))}update(){const t=localStorages.get("FTCompletionStats"),e=[],a=[],s=[],o=[],i=[],r=dateSelector.getFromTime(),n=dateSelector.getToTime();t.forEach((t,l)=>{-1!==l.indexOf("-Date-")&&t.time>=r&&t.time<=n&&(e.push(makeMMDDYYYY(t.time)),a.push(t.confirmed),s.push(t.declined),o.push(t.passive),i.push(t.cancel))}),dashFTComplChart.init({legend:["Confirmed","Declined","Passive","Cancel"],labels:e,colors:[],series:[{name:"Confirmed",type:"line",smooth:!0,itemStyle:{normal:{areaStyle:{type:"default"}}},data:a},{name:"Declined",type:"line",smooth:!0,itemStyle:{normal:{areaStyle:{type:"default"}}},data:s},{name:"Passive",type:"line",smooth:!0,itemStyle:{normal:{areaStyle:{type:"default"}}},data:o},{name:"Cancel",type:"line",smooth:!0,itemStyle:{normal:{areaStyle:{type:"default"}}},data:i}]})}init(t){t||(t={legend:["Confirmed","Declined","Passive","Cancel"],labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],series:[{name:"Confirmed"},{name:"Declined"},{name:"Passive"},{name:"Cancel"}],colors:[getRGBAString("Confirmed"),getRGBAString("Declined"),getRGBAString("Passive"),getRGBAString("Cancel")]});try{this.chart.setOption({tooltip:{trigger:"axis"},legend:{textStyle:{color:"#9aa0ac"},data:t.legend},toolbox:{show:!1},calculable:!1,xAxis:[{type:"category",data:t.labels,axisLabel:{fontSize:10,color:"#9aa0ac"}}],yAxis:[{type:"value",axisLabel:{fontSize:10,color:"#9aa0ac"}}],series:t.series,color:t.colors})}catch(t){console.log("dashFTComplChart failed to init",t)}}}const dashFTComplChart=new dashFTchartSingletone;dashFTComplChart.init(),updateQueue.push(dashFTComplChart.update);class dashOBTCasesChartSingletone{constructor(){this.chart=echarts.init(document.getElementById("dashboard-chart-obt-cases"))}init(t){t||(t={category:["2000","2001","2002","2003","2004","2005"],builds:[22,54,37,23,25.6,76],assignments:[35,45,47,10,35,70],updates:[11,25,45,15,25,40]});try{this.chart.setOption({responsive:!0,maintainAspectRatio:!1,tooltip:{trigger:"axis"},legend:{textStyle:{color:"#9aa0ac"},data:["Builds","Assignments","Updates"]},toolbox:{show:1},calculable:1,xAxis:[{type:"category",data:t.category,axisLabel:{fontSize:10,color:"#9aa0ac"}}],yAxis:[{type:"value",axisLabel:{fontSize:10,color:"#9aa0ac"}}],series:[{name:"Builds",type:"bar",data:t.builds,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Assignments",type:"bar",data:t.assignments,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Updates",type:"bar",data:t.updates,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}}],color:["#65a986","#4f8bb7","#d68e41"]})}catch(t){console.log("dashOBTCasesChart failed to init",t)}}getChartMode(t,e){let a=(e-t)/24/60/60/1e3;return a<60?"Date":a<700?"Month":"Year"}update(){const t=localStorages.get("OBTCasesStats"),e=[],a=[],s=[],o=[],i=dateSelector.getFromTime(),r=dateSelector.getToTime();let n=dashOBTCasesChart.getChartMode(i,r);t.forEach((t,l)=>{-1!==l.indexOf(`-${n}-`)&&t.time>=i&&t.time<=r&&("Date"==n?e.push(makeMMDDYYYY(t.time)):"Month"==n?e.push(makeMMMYYYY(t.time)):e.push(makeYYYY(t.time)),a.push(t.builds),s.push(t.assignments),o.push(t.updates))}),dashOBTCasesChart.init({category:e,builds:a,assignments:s,updates:o})}}const dashOBTCasesChart=new dashOBTCasesChartSingletone;dashOBTCasesChart.init(),updateQueue.push(dashOBTCasesChart.update);class dashTotalChartSingletone{constructor(){this.chart=echarts.init(document.getElementById("dashboard-chart-total-main"))}init(t){t||(t={category:["2000","2001","2002","2003","2004","2005"],cases:[22,54,37,23,25.6,76],appointments:[35,45,47,10,35,70]});try{this.chart.setOption({responsive:!0,maintainAspectRatio:!1,tooltip:{trigger:"axis"},legend:{textStyle:{color:"#9aa0ac"},data:["Cases","Appointments"]},toolbox:{show:1},calculable:1,xAxis:[{type:"category",data:t.category,axisLabel:{fontSize:10,color:"#9aa0ac"}}],yAxis:[{type:"value",axisLabel:{fontSize:10,color:"#9aa0ac"}}],series:[{name:"Cases",type:"bar",data:t.cases},{name:"Appointments",type:"bar",data:t.appointments}],color:["#65a986","#4f8bb7"]})}catch(t){console.log("dashTotalChart failed to init",t)}}getChartMode(t,e){let a=(e-t)/24/60/60/1e3;return a<60?"Date":a<700?"Month":"Year"}update(){const t=dateSelector.getFromTime(),e=dateSelector.getToTime(),a={category:[],cases:[],appointments:[]};let s=dashTotalChart.getChartMode(t,e);localStorages["by"+s].forEach((o,i)=>{o.time>=t&&o.time<=e&&("Date"==s?a.category.push(makeMMDDYYYY(o.time)):"Month"==s?a.category.push(makeMMMYYYY(o.time)):a.category.push(makeYYYY(o.time)),a.cases.push(Object.prototype.hasOwnProperty.call(o,"OBTCasesStats")?o.OBTCasesStats.total:0),a.appointments.push(Object.prototype.hasOwnProperty.call(o,"OBTAppStats")?o.OBTAppStats.total:0))});try{dashTotalChart.chart.setOption({xAxis:{data:a.category},series:[{name:"Cases",type:"line",label:{normal:{show:!0,position:"top"}},data:a.cases},{name:"Appointments",type:"line",label:{normal:{show:!0,position:"top"}},data:a.appointments}]})}catch(t){console.log("dashTotalChart failed to update",t)}}}const dashTotalChart=new dashTotalChartSingletone;dashTotalChart.init(),updateQueue.push(dashTotalChart.update);const DashboardCards=["OBTCasesStats","OBTAppStats","FTCompletionStats","CRMAppStats"];function getDashboardCardsStats(){const t={};return DashboardCards.forEach(e=>{const a=localStorages.get(e),s=a.get(e+"-PreviousePeriod"),o=a.get(e+"-CurrentPeriod"),i=0==s.total?101:Math.round(o.total/s.total*1e4)/100,r={number:o.total?o.total:0,progress:(i||0)+"%",arrow:s.total<=o.total,percents:(i?Math.round(100*Math.abs(i-100))/100:0)+"%",last:s.total?s.total:0};t[e]=r}),console.log("getDashboardCardsStats",t),t}function updateAllDashboardCards(){const t=getDashboardCardsStats();for(const e of DashboardCards)updateDashboardCard(e,t[e])}function updateDashboardCard(t,e){const a=document.getElementById(`dashboard-top-card-${t}-this-month`),s=document.getElementById(`dashboard-top-card-${t}-progressbar`),o=document.getElementById(`dashboard-top-card-${t}-compare-to-last-month-percents`);a.innerHTML=e.number+` (prev. ${e.last})`,s.setAttribute("style",`width: ${e.progress};`),o.innerHTML=`<i class="fa fa-arrow-${e.arrow?"up":"down"}"></i> ${e.percents}`}updateQueue.push(updateAllDashboardCards);class obtCasesByTeamProgressObject{constructor(){this.total=0,this.percents=0}}class obtCasesByTeamTotalSingletone{constructor(){this.total=0,this.midmarket=new obtCasesByTeamProgressObject,this.enterprise=new obtCasesByTeamProgressObject,this.fasttrack=new obtCasesByTeamProgressObject,this.migration=new obtCasesByTeamProgressObject,this.insidesales=new obtCasesByTeamProgressObject,this.channel=new obtCasesByTeamProgressObject,this.franchise=new obtCasesByTeamProgressObject,this.otherSale=new obtCasesByTeamProgressObject}sum(){this.total=this.midmarket.total+this.enterprise.total+this.fasttrack.total+this.migration.total+this.otherSale.total}percents(){if(0==this.total)return console.log("!!!!!!! obtCasesByTeamTotalSingletone total is equal to 0");this.midmarket.percents=Math.floor(this.midmarket.total/this.total*100),this.enterprise.percents=Math.floor(this.enterprise.total/this.total*100),this.fasttrack.percents=Math.floor(this.fasttrack.total/this.total*100),this.migration.percents=Math.floor(this.migration.total/this.total*100),this.otherSale.percents=Math.floor(this.otherSale.total/this.total*100)}}class obtChartCasesByTeamSingletone{constructor(){this.chart=echarts.init(document.getElementById("obt-chart-cases-by-team"))}init(t){t||(t={category:["2000","2001","2002","2003","2004","2005"],mid:[22,54,37,23,25.6,76],enterprise:[35,45,47,10,35,70],fasttrack:[11,25,45,15,25,40],migration:[11,25,45,15,25,40],insidesales:[11,25,45,15,25,40],channel:[11,25,45,15,25,40],franchise:[11,25,45,15,25,40],otherSale:[11,25,45,15,25,40]});try{this.chart.setOption({tooltip:{trigger:"axis"},legend:{textStyle:{color:"#9aa0ac"},data:["Mid Market","Enterprise","Fast Track","Migrations","Other"]},toolbox:{show:1},calculable:1,xAxis:[{type:"category",data:t.category,axisLabel:{fontSize:10,color:"#9aa0ac"}}],yAxis:[{type:"value",axisLabel:{fontSize:10,color:"#9aa0ac"}}],series:[{name:"Mid Market",type:"bar",data:t.mid,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Enterprise",type:"bar",data:t.enterprise,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Fast Track",type:"bar",data:t.fasttrack,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Migrations",type:"bar",data:t.migration,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Other",type:"bar",data:t.otherSale,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}}],color:["#876a6c","#8ca8b0","#264e70","#d2c3a7","#7f9413"]})}catch(t){console.log("obtChartCasesByTeam failed to init",t)}}getChartMode(t,e){let a=(e-t)/24/60/60/1e3;return a<60?"Date":a<700?"Month":"Year"}update(){const t=localStorages.get("OBTCasesStats"),e=[],a=[],s=[],o=[],i=[],r=[],n=dateSelector.getFromTime(),l=dateSelector.getToTime(),c=new obtCasesByTeamTotalSingletone;let d=obtChartCasesByTeam.getChartMode(n,l);t.forEach((t,h)=>{-1!==h.indexOf(`-${d}-`)&&t.time>=n&&t.time<=l&&("Date"==d?e.push(makeMMDDYYYY(t.time)):"Month"==d?e.push(makeMMMYYYY(t.time)):e.push(makeYYYY(t.time)),a.push(t.mid),c.midmarket.total+=parseInt(t.mid),s.push(t.enterprise),c.enterprise.total+=parseInt(t.enterprise),o.push(t.fasttrack),c.fasttrack.total+=parseInt(t.fasttrack),i.push(t.migration),c.migration.total+=parseInt(t.migration),r.push(t.otherSale+t.franchise+t.channel+t.insidesales),c.otherSale.total+=parseInt(t.otherSale+t.franchise+t.channel+t.insidesales))}),c.sum(),c.percents(),updateOBTCasesByTeamProgress(c),obtChartCasesByTeam.init({category:e,mid:a,enterprise:s,fasttrack:o,migration:i,otherSale:r})}}const obtChartCasesByTeam=new obtChartCasesByTeamSingletone;function updateOBTCasesByTeamProgress(t){document.getElementById("obt-cases-by-team-progress-total-cases").innerHTML=t.total,document.getElementById("obt-cases-by-team-progress-midmarket-total-cases").innerHTML=t.midmarket.total,document.getElementById("obt-cases-by-team-progress-midmarket-percents").innerHTML=t.midmarket.percents+"%",document.getElementById("obt-cases-by-team-progress-midmarket-progress-bar").style.width=t.midmarket.percents+"%",document.getElementById("obt-cases-by-team-progress-enterprise-total-cases").innerHTML=t.enterprise.total,document.getElementById("obt-cases-by-team-progress-enterprise-percents").innerHTML=t.enterprise.percents+"%",document.getElementById("obt-cases-by-team-progress-enterprise-progress-bar").style.width=t.enterprise.percents+"%",document.getElementById("obt-cases-by-team-progress-fasttrack-total-cases").innerHTML=t.fasttrack.total,document.getElementById("obt-cases-by-team-progress-fasttrack-percents").innerHTML=t.fasttrack.percents+"%",document.getElementById("obt-cases-by-team-progress-fasttrack-progress-bar").style.width=t.fasttrack.percents+"%",document.getElementById("obt-cases-by-team-progress-migration-total-cases").innerHTML=t.migration.total,document.getElementById("obt-cases-by-team-progress-migration-percents").innerHTML=t.migration.percents+"%",document.getElementById("obt-cases-by-team-progress-migration-progress-bar").style.width=t.migration.percents+"%",document.getElementById("obt-cases-by-team-progress-otherSale-total-cases").innerHTML=t.otherSale.total,document.getElementById("obt-cases-by-team-progress-otherSale-percents").innerHTML=t.otherSale.percents+"%",document.getElementById("obt-cases-by-team-progress-otherSale-progress-bar").style.width=t.otherSale.percents+"%"}obtChartCasesByTeam.init(),updateQueue.push(obtChartCasesByTeam.update);class obtCasesByTypeProgressObject{constructor(){this.total=0,this.percents=0}}class obtCasesByTypeTotalSingletone{constructor(){this.total=0,this.builds=new obtCasesByTypeProgressObject,this.assignments=new obtCasesByTypeProgressObject,this.updates=new obtCasesByTypeProgressObject}sum(){this.total=this.builds.total+this.assignments.total+this.updates.total}percents(){if(0==this.total)return console.log("!!!!!!! obtCasesByTypeTotalSingletone total is equal to 0");this.builds.percents=Math.floor(this.builds.total/this.total*100),this.assignments.percents=Math.floor(this.assignments.total/this.total*100),this.updates.percents=Math.floor(this.updates.total/this.total*100)}}class obtChartCasesByTypeSingletone{constructor(){this.chart=echarts.init(document.getElementById("obt-chart-cases-by-type"))}init(t){t||(t={category:["2000","2001","2002","2003","2004","2005"],builds:[22,54,37,23,25.6,76],assignments:[35,45,47,10,35,70],updates:[11,25,45,15,25,40]});try{this.chart.setOption({tooltip:{trigger:"axis"},legend:{textStyle:{color:"#9aa0ac"},data:["Builds","Assignments","Updates"]},toolbox:{show:1},calculable:1,xAxis:[{type:"category",data:t.category,axisLabel:{fontSize:10,color:"#9aa0ac"}}],yAxis:[{type:"value",axisLabel:{fontSize:10,color:"#9aa0ac"}}],series:[{name:"Builds",type:"bar",data:t.builds,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Assignments",type:"bar",data:t.assignments,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Updates",type:"bar",data:t.updates,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}}],color:["#65a986","#4f8bb7","#d68e41"]})}catch(t){console.log("obtChartCasesByType failed to init",t)}}getChartMode(t,e){let a=(e-t)/24/60/60/1e3;return a<60?"Date":a<700?"Month":"Year"}update(){const t=localStorages.get("OBTCasesStats"),e=[],a=[],s=[],o=[],i=dateSelector.getFromTime(),r=dateSelector.getToTime(),n=new obtCasesByTypeTotalSingletone;let l=obtChartCasesByType.getChartMode(i,r);t.forEach((t,c)=>{-1!==c.indexOf(`-${l}-`)&&t.time>=i&&t.time<=r&&("Date"==l?e.push(makeMMDDYYYY(t.time)):"Month"==l?e.push(makeMMMYYYY(t.time)):e.push(makeYYYY(t.time)),a.push(t.builds),n.builds.total+=parseInt(t.builds),s.push(t.assignments),n.assignments.total+=parseInt(t.assignments),o.push(t.updates),n.updates.total+=parseInt(t.updates))}),n.sum(),n.percents(),updateOBTCasesByTypeProgress(n),obtChartCasesByType.init({category:e,builds:a,assignments:s,updates:o})}}const obtChartCasesByType=new obtChartCasesByTypeSingletone;function updateOBTCasesByTypeProgress(t){document.getElementById("obt-cases-by-type-progress-total-cases").innerHTML=t.total,document.getElementById("obt-cases-by-type-progress-builds-total-cases").innerHTML=t.builds.total,document.getElementById("obt-cases-by-type-progress-builds-percents").innerHTML=t.builds.percents+"%",document.getElementById("obt-cases-by-type-progress-builds-progress-bar").style.width=t.builds.percents+"%",document.getElementById("obt-cases-by-type-progress-assignments-total-cases").innerHTML=t.assignments.total,document.getElementById("obt-cases-by-type-progress-assignments-percents").innerHTML=t.assignments.percents+"%",document.getElementById("obt-cases-by-type-progress-assignments-progress-bar").style.width=t.assignments.percents+"%",document.getElementById("obt-cases-by-type-progress-updates-total-cases").innerHTML=t.updates.total,document.getElementById("obt-cases-by-type-progress-updates-percents").innerHTML=t.updates.percents+"%",document.getElementById("obt-cases-by-type-progress-updates-progress-bar").style.width=t.updates.percents+"%"}obtChartCasesByType.init(),updateQueue.push(obtChartCasesByType.update);class obtChartCasesPerAgentSingletone{constructor(){this.chart=echarts.init(document.getElementById("obt-chart-cases-per-agent"))}init(t){t||(t={category:["2000","2001","2002","2003","2004","2005"],builds:[22,54,37,23,25.6,76],assignments:[35,45,47,10,35,70],updates:[11,25,45,15,25,40]});try{this.chart.setOption({tooltip:{trigger:"axis"},legend:{textStyle:{color:"#9aa0ac"},data:["Builds","Assignments","Updates"]},toolbox:{show:1},calculable:1,xAxis:[{type:"category",data:t.category,axisLabel:{rotate:-45,fontSize:10,color:"#9aa0ac"}}],yAxis:[{type:"value",axisLabel:{fontSize:10,color:"#9aa0ac"}}],series:[{name:"Builds",type:"bar",data:t.builds,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Assignments",type:"bar",data:t.assignments,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}},{name:"Updates",type:"bar",data:t.updates,markPoint:{data:[{type:"max",name:"???"},{type:"min",name:"???"}]},markLine:{data:[{type:"average",name:"???"}]}}],color:["#65a986","#4f8bb7","#d68e41"]})}catch(t){console.log("obtChartCasesPerAgent failed to init",t)}}getChartMode(t,e){let a=(e-t)/24/60/60/1e3;return a<60?"Date":a<700?"Month":"Year"}update(){const t=localStorages.get("OBTCasesStats"),e=[],a=[],s=[],o=[];let i=new Map;const r=dateSelector.getFromTime(),n=dateSelector.getToTime();t.forEach((t,e)=>{if(-1!==e.indexOf("-Agent-")&&t.time>=r&&t.time<=n){const a={name:"",builds:0,assignments:0,updates:0,add:function(t){this.builds+=t.builds,this.assignments+=t.assignments,this.updates+=t.updates},init:function(e,a){e&&(this.name=a,this.builds=t.builds,this.assignments=e.assignments,this.updates=e.updates)}};a.init(i.get(e.split("-")[2].split("@")[0]),e.getName()),a.add(t),i.set(e.split("-")[2].split("@")[0],a)}}),i=new Map([...i.entries()].sort((function(t,e){return(""+t.name).localeCompare(e.name)}))),i.forEach(t=>{e.push(t.name),a.push(t.builds),s.push(t.assignments),o.push(t.updates)}),obtChartCasesPerAgent.init({category:e,builds:a,assignments:s,updates:o})}}const obtChartCasesPerAgent=new obtChartCasesPerAgentSingletone;function combineByDate(t,e,a){if("Agent"===t[1]||"teamRoaster"===t[0])return;let s=localStorages["by"+t[1]].get(t[2]);s||(s={time:a.time}),s[e]=new classes[e](a),localStorages["by"+t[1]].set(t[2],s)}function combineByDateSort(){localStorages.byDate=new Map([...localStorages.byDate.entries()].sort((function(t,e){return t[1].time-e[1].time}))),localStorages.byMonth=new Map([...localStorages.byMonth.entries()].sort((function(t,e){return t[1].time-e[1].time}))),localStorages.byYear=new Map([...localStorages.byYear.entries()].sort((function(t,e){return t[1].time-e[1].time})))}obtChartCasesPerAgent.init(),updateQueue.push(obtChartCasesPerAgent.update),localStorages.byDate=new Map,localStorages.byMonth=new Map,localStorages.byYear=new Map,$(".obt-dashboard-left-menu-item").on("click",(function(t){$(".obt-dashboard-page-container").hide(),$(".obt-dashboard-left-menu-item").removeClass("active"),$(this).addClass("active");const e=$(this).attr("page");$("#obt-dashboard-page-"+e).show()}));class leftMenuSingletone{constructor(){}updateName(t){$("#obt-dashboard-left-menu-username").text(getNameFromEmail(t[0])),$("#obt-dashboard-left-menu-avatar").attr("src",`https://icotar.com/avatar/${t[0].split("@")[0]}.png?s=500`)}}const leftMenu=new leftMenuSingletone;function saveStats(t){const e=t[0].split("-"),a=localStorages.get(e[0]);try{let s=JSON.parse(t[2]);"Array"==t[1]?a.set(t[0],s):(a.set(t[0],new classes[t[1]](s)),combineByDate(e,t[1],s))}catch(e){console.log(`storage.set(${t[0]}, new classes[${t[1]}](JSON.parse()));`),console.log("error",e)}}onLoadQueue.push(leftMenu.updateName);